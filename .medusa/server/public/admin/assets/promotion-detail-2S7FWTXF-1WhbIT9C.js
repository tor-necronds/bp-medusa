import{D as S}from"./chunk-NL376WAO-D_RRdl9c.js";import{g as P}from"./chunk-SC6BSTC7-7K2MqRlj.js";import{f as D}from"./chunk-4FM6S5CX-BpW1LsFY.js";import{f as R}from"./chunk-WATKBUHQ-C3WbDglz.js";import{N as _}from"./chunk-EMIHDNB7-DRJ-T97v.js";import{T as u}from"./chunk-GIZFNLKK-e0zDfWbO.js";import{e as $,ah as C,e8 as T,e5 as p,a as B,j as e,ai as A,s as q,dZ as L,q as k,b as x,h as M,u as I,d$ as O,C as h,H as f,aj as V,A as j,P as y,T as Q,a5 as n,di as U,ao as m,bR as E,_ as H,al as J}from"./index-DsV72Lgh.js";import"./chunk-DZWH2RV6-DwC22Jxm.js";import"./Trans-J1LkaaR0.js";var de=s=>{const{id:t}=s.params||{},{promotion:a}=T(t,{initialData:s.data,enabled:!!t});return a?e.jsx("span",{children:a.code}):null},K=s=>({queryKey:L.detail(s),queryFn:async()=>q.admin.promotion.retrieve(s)}),me=async({params:s})=>{const t=s.id,a=K(t);return k.ensureQueryData(a)},W=({campaign:s})=>e.jsxs("div",{className:"flex flex-col gap-y-3",children:[e.jsxs("div",{className:"text-ui-fg-muted flex items-center gap-x-1.5",children:[e.jsx(n,{size:"small",weight:"plus",className:"text-ui-fg-base",children:s.name}),e.jsx(n,{size:"small",weight:"plus",children:"Â·"}),e.jsx(n,{size:"small",weight:"plus",children:s.campaign_identifier})]}),e.jsx(S,{startsAt:s.starts_at,endsAt:s.ends_at,showTime:!0})]}),F=({campaign:s})=>{const{t}=x(),{id:a}=C(),i=[{label:t("actions.edit"),to:"add-to-campaign",icon:e.jsx(y,{})}];return s&&i.unshift({label:t("promotions.campaign.actions.goToCampaign"),to:`/campaigns/${s.id}`,icon:e.jsx(E,{})}),e.jsxs(h,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(f,{level:"h2",children:t("promotions.fields.campaign")}),e.jsx(j,{groups:[{actions:i}]})]}),s?e.jsx(W,{campaign:s}):e.jsx(_,{className:"h-[180px] pt-4 text-center",title:"Not part of a campaign",message:"Add this promotion to an existing campaign",action:{to:`/promotions/${a}/add-to-campaign`,label:"Add to Campaign"},buttonVariant:"transparentIconLeft"})]})},G=({list:s,className:t,inline:a,rounded:i=!1,n:l=2})=>{const{t:r}=x(),o=r("general.plusCount",{count:s.length-l});return e.jsxs("div",{className:H("text-ui-fg-subtle txt-compact-small gap-x-2 overflow-hidden",{"inline-flex":a,flex:!a},t),children:[s.slice(0,l).map(c=>e.jsx(m,{rounded:i?"full":"base",size:"2xsmall",children:c},c)),s.length>l&&e.jsx("div",{className:"whitespace-nowrap",children:e.jsx(J,{content:e.jsx("ul",{children:s.slice(l).map(c=>e.jsx("li",{children:c},c))}),children:e.jsx(m,{rounded:i?"full":"base",size:"2xsmall",className:"cursor-default whitespace-nowrap",children:o})})})]})};function Y({rule:s}){var t;return e.jsx("div",{className:"bg-ui-bg-subtle shadow-borders-base align-center flex justify-around rounded-md p-2",children:e.jsxs("div",{className:"text-ui-fg-subtle txt-compact-xsmall flex items-center whitespace-nowrap",children:[e.jsx(m,{size:"2xsmall",className:"txt-compact-xsmall-plus tag-neutral-text mx-1 inline-block truncate",children:s.attribute_label},"rule-attribute"),e.jsx("span",{className:"txt-compact-2xsmall mx-1 inline-block",children:s.operator_label}),e.jsx(G,{inline:!0,className:"!txt-compact-small-plus",list:s.field_type==="number"?[s.values]:(t=s.values)==null?void 0:t.map(a=>a.label)})]})})}var g=({rules:s,ruleType:t,applicationMethodTargetType:a})=>{const{t:i}=x();return e.jsxs(h,{className:"p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx("div",{className:"flex flex-col",children:e.jsx(f,{level:"h2",children:i(t==="target-rules"?`promotions.fields.conditions.${t}.${a}.title`:`promotions.fields.conditions.${t}.title`)})}),e.jsx(j,{groups:[{actions:[{icon:e.jsx(y,{}),label:i("actions.edit"),to:`${t}/edit`}]}]})]}),e.jsxs("div",{className:"text-ui-fg-subtle flex flex-col gap-2 px-6 pb-4 pt-2",children:[!s.length&&e.jsx(_,{className:"h-[180px]",title:i("general.noRecordsTitle"),message:i("promotions.conditions.list.noRecordsMessage"),action:{to:`${t}/edit`,label:i("promotions.conditions.add")},buttonVariant:"transparentIconLeft"}),s.map(l=>e.jsx(Y,{rule:l},`${l.id}-${l.attribute}`))]})]})};function Z(s){var a,i,l,r;const t=(a=s.application_method)==null?void 0:a.value;if(!t)return null;if(((i=s.application_method)==null?void 0:i.type)==="fixed"){const o=(l=s.application_method)==null?void 0:l.currency_code;return o?R(t,o):null}else if(((r=s.application_method)==null?void 0:r.type)==="percentage")return D(t);return null}var X=({promotion:s})=>{var b,v,N,w,z;const{t}=x(),a=M(),i=I(),{mutateAsync:l}=O(s.id),r=async()=>{await a({title:t("general.areYouSure"),description:t("promotions.deleteWarning",{code:s.code}),verificationInstruction:t("general.typeToConfirm"),verificationText:s.code,confirmText:t("actions.delete"),cancelText:t("actions.cancel")})&&await l(void 0,{onSuccess:()=>{i("/promotions",{replace:!0})}})},[o,c]=P(s),d=Z(s);return e.jsxs(h,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx("div",{className:"flex flex-col",children:e.jsx(f,{children:s.code})}),e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx(V,{color:o,children:c}),e.jsx(j,{groups:[{actions:[{icon:e.jsx(y,{}),label:t("actions.edit"),to:`/promotions/${s.id}/edit`}]},{actions:[{icon:e.jsx(Q,{}),label:t("actions.delete"),onClick:r}]}]})]})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-start px-6 py-4",children:[e.jsx(n,{size:"small",weight:"plus",leading:"compact",children:t("promotions.fields.campaign")}),e.jsx(n,{size:"small",leading:"compact",className:"text-pretty",children:s.is_automatic?t("promotions.form.method.automatic.title"):t("promotions.form.method.code.title")})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[e.jsx(n,{size:"small",weight:"plus",leading:"compact",children:t("fields.code")}),e.jsx(U,{content:s.code,className:"text-ui-tag-neutral-text",asChild:!0,children:e.jsx(m,{size:"2xsmall",rounded:"full",className:"cursor-pointer text-pretty",children:s.code})})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-start px-6 py-4",children:[e.jsx(n,{size:"small",weight:"plus",leading:"compact",children:t("promotions.fields.type")}),e.jsx(n,{size:"small",leading:"compact",className:"text-pretty capitalize",children:s.type})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-start px-6 py-4",children:[e.jsx(n,{size:"small",weight:"plus",leading:"compact",children:t("promotions.fields.value")}),e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx(n,{className:"inline",size:"small",leading:"compact",children:d||"-"}),((b=s==null?void 0:s.application_method)==null?void 0:b.type)==="fixed"&&e.jsx(m,{size:"2xsmall",rounded:"full",children:(N=(v=s==null?void 0:s.application_method)==null?void 0:v.currency_code)==null?void 0:N.toUpperCase()})]})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-start px-6 py-4",children:[e.jsx(n,{size:"small",weight:"plus",leading:"compact",children:t("promotions.fields.allocation")}),e.jsx(n,{size:"small",leading:"compact",className:"text-pretty capitalize",children:(w=s.application_method)==null?void 0:w.allocation})]}),((z=s.application_method)==null?void 0:z.type)==="fixed"&&e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-start px-6 py-4",children:[e.jsx(n,{size:"small",weight:"plus",leading:"compact",children:t("promotions.fields.taxInclusive")}),e.jsx("div",{className:"flex items-center gap-x-2",children:e.jsx(n,{className:"inline",size:"small",leading:"compact",children:s.is_tax_inclusive?t("fields.true"):t("fields.false")})})]}),typeof s.limit=="number"&&e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-start px-6 py-4",children:[e.jsx(n,{size:"small",weight:"plus",leading:"compact",children:"Usage Limit"}),e.jsx("div",{className:"flex items-center gap-x-2",children:e.jsxs(n,{className:"inline",size:"small",leading:"compact",children:[s.used||0," / ",s.limit]})})]})]})},xe=()=>{const s=$(),{id:t}=C(),{promotion:a,isLoading:i}=T(t,{initialData:s}),l={};(a==null?void 0:a.type)==="buyget"&&(l.promotion_type=a.type);const{rules:r}=p(t,"rules",l),{rules:o}=p(t,"target-rules",l),{rules:c}=p(t,"buy-rules",l),{getWidgets:d}=B();return i||!a?e.jsx(A,{mainSections:3,sidebarSections:1,showJSON:!0}):e.jsxs(u,{data:a,widgets:{after:d("promotion.details.after"),before:d("promotion.details.before"),sideAfter:d("promotion.details.side.after"),sideBefore:d("promotion.details.side.before")},hasOutlet:!0,showJSON:!0,children:[e.jsxs(u.Main,{children:[e.jsx(X,{promotion:a}),e.jsx(g,{rules:r||[],ruleType:"rules"}),e.jsx(g,{rules:o||[],ruleType:"target-rules",applicationMethodTargetType:a.application_method.target_type||"items"}),a.type==="buyget"&&e.jsx(g,{rules:c||[],ruleType:"buy-rules",applicationMethodTargetType:"items"})]}),e.jsx(u.Sidebar,{children:e.jsx(F,{campaign:a.campaign})})]})};export{de as Breadcrumb,xe as Component,me as loader};
