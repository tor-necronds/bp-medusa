import{u as I}from"./chunk-BW322BVH-DJY7GZ68.js";import{ah as z,bt as A,j as t,b as x,r as b,aD as B,aE as D,ax as H,f as M,bu as N,t as h,a3 as K,B as f,aI as L,az as O,g as V,al as q,a4 as y}from"./index-DsV72Lgh.js";import{u as G,_ as Q}from"./chunk-YTN73JYH-CNuodvoK.js";import{u as U,a as X}from"./chunk-OAW7KLET-Ca2z0AL2.js";import"./chunk-GU5PJRPM-O5M6LXf4.js";import{K as Z}from"./chunk-6HTZNHPT-DGQV_Lcz.js";import{R as l,u as $}from"./chunk-AERWK3TJ-DmmmqBU-.js";import"./chunk-XLDQPLK4-DoJ3EZdL.js";import"./chunk-ADOCJB6L-D4BK0_qi.js";import"./chunk-P3UUX2T6-BC4tQC_j.js";import"./chunk-IQBAUTU5-jvNXNAr8.js";import"./chunk-HQKGZADC-Dbir7G86.js";import"./chunk-EMIHDNB7-DRJ-T97v.js";import"./chunk-C76H5USB-CiyvsDlP.js";import"./chunk-DZWH2RV6-DwC22Jxm.js";import"./index-Do-4R60H.js";var J=H({product_ids:L(O())}),u=50,p="p",W=({categoryId:c,products:o=[]})=>{const{t:e}=x(),{handleSuccess:a}=$(),[d,n]=b.useState(o.reduce((s,i)=>(s[i.id]=!0,s),{})),r=B({defaultValues:{product_ids:[]},resolver:D(J)}),P=s=>{const i=typeof s=="function"?s(d):s;r.setValue("product_ids",Object.keys(i),{shouldDirty:!0,shouldTouch:!0}),n(i)},{searchParams:S,raw:j}=U({pageSize:u,prefix:p}),{products:C,count:m,isPending:v,isError:T,error:_}=M({...S}),g=ee(),E=X(["categories"]),{table:k}=G({data:C,columns:g,getRowId:s=>s.id,count:m,pageSize:u,prefix:p,enableRowSelection:s=>!o.some(i=>i.id===s.original.id),enablePagination:!0,rowSelection:{state:d,updater:P}}),{mutateAsync:R,isPending:F}=N(c),w=r.handleSubmit(async s=>{await R({add:s.product_ids},{onSuccess:()=>{h.success(e("categories.products.add.successToast",{count:s.product_ids.length-o.length})),a()},onError:i=>{h.error(i.message)}})});if(T)throw _;return t.jsx(l.Form,{form:r,children:t.jsxs(Z,{onSubmit:w,className:"flex h-full flex-col overflow-hidden",children:[t.jsx(l.Header,{children:t.jsx("div",{className:"flex items-center justify-end gap-x-2",children:r.formState.errors.product_ids&&t.jsx(K,{variant:"error",children:r.formState.errors.product_ids.message})})}),t.jsx(l.Body,{className:"size-full overflow-hidden",children:t.jsx(Q,{table:k,columns:g,pageSize:u,count:m,queryObject:j,filters:E,orderBy:[{key:"title",label:e("fields.title")},{key:"created_at",label:e("fields.createdAt")},{key:"updated_at",label:e("fields.updatedAt")}],prefix:p,isLoading:v,layout:"fill",pagination:!0,search:"autofocus"})}),t.jsxs(l.Footer,{children:[t.jsx(l.Close,{asChild:!0,children:t.jsx(f,{size:"small",variant:"secondary",children:e("actions.cancel")})}),t.jsx(f,{size:"small",type:"submit",isLoading:F,children:e("actions.save")})]})]})})},Y=V(),ee=()=>{const{t:c}=x(),o=I();return b.useMemo(()=>[Y.display({id:"select",header:({table:e})=>t.jsx(y,{checked:e.getIsSomePageRowsSelected()?"indeterminate":e.getIsAllPageRowsSelected(),onCheckedChange:a=>e.toggleAllPageRowsSelected(!!a)}),cell:({row:e})=>{const a=!e.getCanSelect(),d=e.getIsSelected()||a,n=t.jsx(y,{checked:d,disabled:a,onCheckedChange:r=>e.toggleSelected(!!r),onClick:r=>{r.stopPropagation()}});return a?t.jsx(q,{content:c("categories.products.add.disabledTooltip"),side:"right",children:n}):n}}),...o],[c,o])},ye=()=>{const{id:c}=z(),{product_category:o,isPending:e,isFetching:a,isError:d,error:n}=A(c,{fields:"products.id"}),r=!e&&!a&&!!o;if(d)throw n;return t.jsx(l,{children:r&&t.jsx(W,{categoryId:o.id,products:o.products})})};export{ye as Component};
